<html manifest="cache.appcache" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Photo Capture</title>
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
</head>
<body style="padding: 0; margin: 0;">
    <div style="text-align: center">
        <div style="display: inline-block; width: 90%;">
            <div id="debug" style="display: none;"></div>

<script type="text/javascript">

//Output OFSC Android specific camera capture. 

	var ua = navigator.userAgent.toLowerCase();
	var isOFSCAndroid = (ua.indexOf("android") > -1) && (ua.indexOf("oracle.ofsc")  -1); //&& ua.indexOf("mobile");
	if(isOFSCAndroid) {
		document.write('<hr>');
		document.write('<h6>Take a Photo</h6>');
		
		document.write('<br>');
		document.write('<button id="loadCanvas" class="btn btn-primary">Use Camera</button>');
		document.write('<br>');
		document.write('<!-- Camera sensor -->');
		document.write('<canvas id="camera--sensor" style="display: none;"></canvas>');
		document.write('<!-- Camera view -->');
		document.write('<video id="camera--view" style="display: none; max-width: 100%; max-height: 80vh; margin-top: 25px;" autoplay playsinline></video>');
		document.write('<br>');
		document.write('<br>');
		document.write('<!-- Camera trigger -->');
		document.write('<button id="camera--trigger" class="btn btn-primary" disabled>Take a Picture</button>');
		document.write('<br>');
		document.write('<br>');
		document.write('<div id="camera--text"></div>');
		document.write('<br>');
		document.write('<h6>Or Upload a Photo</h6>'); 
	}
	else
	{
		document.write('<h6>Take / Upload A Photo</h6>');
	}

</script>

            <br>
            <!-- test -->
            <div >
                <div class="custom-file">
                <input type="file" style="display: none;" id="files" accept="image/*" onchange="printOriginalFileSelect(event);displayImage(event)" aria-describedby="inputGroupFileAddon04">
                <input type="button" class="btn btn-primary" value="Choose File" onclick="document.getElementById('files').click();">
            </div>
            </div>
            <!-- OLD: <input type="file" id="files" accept="image/*" class="form" onchange="printOriginalFileSelect(event);displayImage(event)" /> -->
            <div id="error" style="color: black;"></div>

            <div id="spinner" class="spinner-border text-secondary" role="status" style="margin: 25px 0; display: none;">
                <span class="sr-only">Loading...</span>
            </div>

            <!-- <h6>Submit or Clear and Try Again</h6> -->
            <br>
            <button id="submit" class="btn btn-primary" onclick="pluginClose(event)" disabled>Submit</button>
            <button id="clear" class="btn btn-danger" onclick="clearImage(event)">Clear</button>
            <br>

            <hr>            
            <!-- Original Image -->
            <a class="online-action" data-label="ew_trouble_photo_04" target="_blank" href="index.php?m=attribute&amp;a=download&amp;sentity=1&amp;eid=5801529&amp;attr_id=4223&amp;ts=1576792815746&amp;sign=HdZ6MXhnwlt2%2F9LnasaEWhAslzgTY3XLFfw9yKvHWJQ%3D">upload.jpeg, 128K</a>
            
            <h6>Image Preview</h6>
            <div id="original-xy" style="display: none;"></div>
            <br>
            <img id="original" src="" alt="" style="max-width: 75%; height: auto;">
            <br>
            <!-- Resized Image (Hidden) -->
            <div id="resized-xy" style="display: none;"></div>
            <br>
            <img id="resized" src="" alt="" style="display: none;">
            <br>
            <hr>
            <div id="originalMetadata" style="width: 50%; float: left; display: none;"></div>
            <!-- <div id="resizedMetadata" style="width: 25%; float: left;"></div> -->
            <div id="resizedMetadataCopied" style="width: 50%; float: left; display: none;"></div>
        </div>
    </div>

    <!-- Custom JavaScript files -->
    <!-- JavaScript library/framework files -->
    <script src="js/jquery-3.4.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/piexif.js"></script>
    <!-- Config must be before main code in app.js -->
    <script src="config.js"></script>
    <script src="app.js"></script>

    <!-- Script to update the files name on upload -->
    <script>
        $('#files').on('change',function(){
            /* Change the file upload element to display the filename */

            // Strip the full path to get the filename
            // var fileString = $(this).val();
            // fileArray = fileString.split("\\");
            // fileName = fileArray[fileArray.length - 1];

            /* Files have strange names when taken on camera */

            // Use a default filename
            fileName = "Uploaded_Image.jpeg";

            //replace the "Choose a file" label
            $(this).next('.custom-file-label').html(fileName);
        })
    </script>
</body>
</html>